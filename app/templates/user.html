{% extends "base.html" %}
{% import 'bootstrap/wtf.html' as wtf %}

{% block app_content %}
<div class="container">
    <table>
        <tr valign="top">
            <h1>{{ user.username }}</h1>
			{% if user.about_me %}<p>{{ user.about_me }}</p>{% endif %}
            {% if user.last_seen %}<p>Last seen on: {{ user.last_seen }}</p>{% endif %}
			<p>{{ user.followers.count() }} followers, {{ user.followed.count() }} following.</p>
			{% if user == current_user %}
			<p><a href="{{ url_for('edit_profile') }}">Edit your profile</a></p>
			{% elif not current_user.is_following(user) %}
			<p><a href="{{ url_for('follow', username=user.username) }}">Follow</a></p>
			{% else %}
			<p><a href="{{ url_for('unfollow', username=user.username) }}">Unfollow</a></p>
			{% endif %}
			
    </table>
    <hr>
    <div class="row">
		<div class="col-md-6">
			{% if user == current_user %}
			<p><a href="#" data-toggle="modal" data-target="#create_project_modal" style="float:right;">Create Project</a></p>
			{% endif %}
			<h3>Portfolio</h3>
			<ul class="nav nav-pills nav-stacked" role="tablist">
				{% if portfolio %}
				{% for p in portfolio %}
				{% if user == current_user %}
				<li><div><span><a href="{{ url_for('project', id=p.id, title=p.title) }}">{{ p.title }}</span></a><a href="#" data-toggle="modal" data-target="#project_edit_modal_{{ p.id }}"><span class="glyphicon glyphicon-pencil" title="edit project name" aria-hidden="true" style="float:right;"></span></a></div></li>
				{% else %}
				<li role="presentation"><a href="#" data-toggle="modal" data-target="#project_modal_{{ p.id }}">{{ p.title }}</a></li>
				{% endif %}
				{% endfor %}
				{% endif %}
			</ul>
		</div>
		<div class="col-md-6">
			<h3>Library</h3>
			<ul class="nav nav-pills nav-stacked" role="tablist">
				{% if library %}
				{% for l in library %}
				{% if user == current_user %}
				<li><a href="{{ url_for('project', id=l.id, title=l.title) }}">{{ l.title }}</a></li>
				{% else %}
				<li role="presentation"><a href="#" data-toggle="modal" data-target="#library_modal_{{ l.id }}">{{ l.title }}</a></li>
				{% endif %}
				{% endfor %}
				{% endif %}
			</ul>
		</div>
	</div>
	
	<div class="modal fade" id="create_project_modal" tabindex="-1" role="dialog" aria-labelledby="create_project_modalLabel">
	  <div class="modal-dialog" role="document">
		<div class="modal-content">
		  <div class="modal-body">
			<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
			{{ wtf.quick_form(form) }}
		  </div>
		</div>
	  </div>
	</div>
	{% if portfolio %}
	{% for p in portfolio %}
	{% if user != current_user %}
	<div class="modal fade" id="project_modal_{{ p.id }}" tabindex="-1" role="dialog" aria-labelledby="project_{{p.id}}_modalLabel">
	  <div class="modal-dialog" role="document">
		<div class="modal-content">
		  <div class="modal-body">
			<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
			<h2 class="text-center">{{ p.title }}</h2>
			<div>{{ p.synopsis }}</div>
		  </div>
		</div>
	  </div>
	</div>
	{% endif %}
	{% if user == current_user %}
	<div class="modal fade" id="project_edit_modal_{{ p.id }}" tabindex="-1" role="dialog" aria-labelledby="project_{{p.id}}_edit_modalLabel">
	  <div class="modal-dialog" role="document">
		<div class="modal-content">
		  <div class="modal-body">
			<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
			<form action method="post" class="form" role="form">
			{{ form2.csrf_token() }}
			{{ form2.proj_id (value=p.id)}}
			{{ form2.edit_title.label (class_='control-label') }}
			{{ form2.edit_title (class_='form-control', value=p.title) }}
			{{ form2.edit_genre.label (class_='control-label') }}
			{{ form2.edit_genre (class_='form-control', value=p.pg_name) }}
			<br>
			{{ form2.edit_synopsis.label (class_='control-label') }}
			<textarea class="form-control" name="edit_synopsis" cols="15" rows="20" maxlength="50000" required>{{p.synopsis}}</textarea>
			<br>
			{{ form2.edit_submit (class_="btn btn-default")}}
			</form>
		  </div>
		</div>
	  </div>
	</div>
	{% endif %}
	{% endfor %}
	{% endif %}
	
	{% if library %}
	{% for l in library %}
	{% if user != current_user %}
	<div class="modal fade" id="library_modal_{{ l.id }}" tabindex="-1" role="dialog" aria-labelledby="library_{{ l.id }}modalLabel">
	  <div class="modal-dialog" role="document">
		<div class="modal-content">
		  <div class="modal-body">
			<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
			<h2 class="text-center">{{ l.title }}</h2>
			<div>{{ l.synopsis }}</div>
		  </div>
		</div>
	  </div>
	</div>
	{% endif %}
	{% endfor %}
	{% endif %}
</div>
{% endblock %}

{% block scripts %}
{{super()}}
<!--set value of textarea -->
<script>
$(document).ready(function() {

});
</script>
{% endblock %}